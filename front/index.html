<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenHouse Connect - Serre Connectée Intelligente</title>
    <link rel="stylesheet" href="/front/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
</head>
<script>
async function checkAuth() {
    const token = localStorage.getItem("token");

    if (!token) {
        window.location.href = "front/login.html";
        return;
    }

    try {
        const response = await fetch("http://172.29.16.154/api/temp", {
            method: "GET",
            headers: {
                "Authorization": "Bearer " + token
            }
        });

        if (response.status === 401) {
            localStorage.removeItem("token");
            window.location.href = "/front/login.html";
        }
    } catch (err) {
        localStorage.removeItem("token");
        window.location.href = "/front/login.html";
    }
}

checkAuth();
</script>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
                    <path d="M20 5C20 5 10 10 10 20C10 25 12 28 15 30C12 28 10 25 10 20C10 15 15 12 20 10C25 12 30 15 30 20C30 25 28 28 25 30C28 28 30 25 30 20C30 10 20 5 20 5Z" fill="#4CAF50"/>
                    <circle cx="20" cy="32" r="3" fill="#8BC34A"/>
                </svg>
                <span class="logo-text">GreenHouse</span>
            </div>
            <ul class="nav-links">
                <li><a href="#dashboard" class="nav-link active">Dashboard</a></li>
                <li><a href="#monitoring" class="nav-link">Surveillance</a></li>
                <li><a href="#controls" class="nav-link">Contrôles</a></li>
                <li><a href="#history" class="nav-link">Historique</a></li>
                <li><a href="#settings" class="nav-link">Paramètres</a></li>
            </ul>
            <div class="nav-status">
                <span class="status-indicator online"></span>
                <span class="status-text">Connecté</span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">Votre Serre Connectée</h1>
            <p class="hero-subtitle">Surveillez et contrôlez votre environnement de culture en temps réel</p>
            <div class="hero-stats">
                <div class="hero-stat">
                    <span class="stat-value" id="hero-temp">--</span>
                    <span class="stat-label">Température</span>
                </div>
                <div class="hero-stat">
                    <span class="stat-value" id="hero-humidity">--</span>
                    <span class="stat-label">Humidité</span>
                </div>
                <div class="hero-stat">
                    <span class="stat-value" id="hero-light">--</span>
                    <span class="stat-label">Luminosité</span>
                </div>
            </div>
        </div>
        <div class="hero-background">
            <div class="leaf-animation leaf-1"></div>
            <div class="leaf-animation leaf-2"></div>
            <div class="leaf-animation leaf-3"></div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Quick Status Cards -->
        <section class="quick-status">
            <div class="status-card temperature-card">
                <div class="card-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <rect x="12" y="4" width="8" height="18" rx="1" stroke="currentColor" stroke-width="2"/>
                        <circle cx="16" cy="25" r="4" fill="currentColor"/>
                        <line x1="16" y1="8" x2="16" y2="21" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <div class="card-content">
                    <h3 class="card-title">Température</h3>
                    <p class="card-value" id="temp-value">--°C</p>
                    <p class="card-status" id="temp-status">Chargement...</p>
                </div>
                <div class="card-chart" id="temp-chart"></div>
            </div>

            <div class="status-card humidity-card">
                <div class="card-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <path d="M16 4C16 4 8 14 8 20C8 24.4 11.6 28 16 28C20.4 28 24 24.4 24 20C24 14 16 4 16 4Z" stroke="currentColor" stroke-width="2" fill="currentColor" opacity="0.3"/>
                    </svg>
                </div>
                <div class="card-content">
                    <h3 class="card-title">Humidité</h3>
                    <p class="card-value" id="humidity-value">--%</p>
                    <p class="card-status" id="humidity-status">Chargement...</p>
                </div>
                <div class="card-chart" id="humidity-chart"></div>
            </div>

            <div class="status-card light-card">
                <div class="card-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <circle cx="16" cy="16" r="6" fill="currentColor"/>
                        <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                        <line x1="16" y1="26" x2="16" y2="30" stroke="currentColor" stroke-width="2"/>
                        <line x1="30" y1="16" x2="26" y2="16" stroke="currentColor" stroke-width="2"/>
                        <line x1="6" y1="16" x2="2" y2="16" stroke="currentColor" stroke-width="2"/>
                        <line x1="25.5" y1="6.5" x2="22.5" y2="9.5" stroke="currentColor" stroke-width="2"/>
                        <line x1="9.5" y1="22.5" x2="6.5" y2="25.5" stroke="currentColor" stroke-width="2"/>
                        <line x1="25.5" y1="25.5" x2="22.5" y2="22.5" stroke="currentColor" stroke-width="2"/>
                        <line x1="9.5" y1="9.5" x2="6.5" y2="6.5" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <div class="card-content">
                    <h3 class="card-title">Luminosité</h3>
                    <p class="card-value" id="light-value">-- lux</p>
                    <p class="card-status" id="light-status">Chargement...</p>
                </div>
                <div class="card-chart" id="light-chart"></div>
            </div>

            <div class="status-card soil-card">
                <div class="card-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <rect x="4" y="18" width="24" height="10" rx="2" fill="currentColor" opacity="0.3"/>
                        <path d="M16 4L14 10L16 16L18 10L16 4Z" fill="currentColor"/>
                        <circle cx="10" cy="23" r="2" fill="currentColor"/>
                        <circle cx="22" cy="23" r="2" fill="currentColor"/>
                    </svg>
                </div>
                <div class="card-content">
                    <h3 class="card-title">Humidité air</h3>
                    <p class="card-value" id="soil-value">--%</p>
                    <p class="card-status" id="soil-status">Chargement...</p>
                </div>
                <div class="card-chart" id="soil-chart"></div>
            </div>
        </section>

        <!-- Controls Section -->
        <section class="controls-section">
            <h2 class="section-title">Contrôles Automatiques</h2>
            <div class="controls-grid">
                <div class="control-panel">
                    <div class="control-header">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M12 2L14 8L12 14L10 8L12 2Z" fill="#4CAF50"/>
                            <path d="M3 14C3 14 5 10 12 10C19 10 21 14 21 14" stroke="#4CAF50" stroke-width="2"/>
                        </svg>
                        <h3>Arrosage Automatique</h3>
                    </div>
                    <div class="control-body">
                        <div class="toggle-switch">
                            <input type="checkbox" id="irrigation-toggle" class="toggle-input">
                            <label for="irrigation-toggle" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                            <span class="toggle-text">Désactivé</span>
                        </div>
                        <div class="control-settings">
                            <label>Seuil d'humidité: <span id="irrigation-threshold">30</span>%</label>
                            <input type="range" id="irrigation-slider" min="0" max="100" value="30" class="slider">
                        </div>
                    </div>
                </div>

                <div class="control-panel">
                    <div class="control-header">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="4" fill="#FF9800"/>
                            <line x1="12" y1="2" x2="12" y2="5" stroke="#FF9800" stroke-width="2"/>
                            <line x1="12" y1="19" x2="12" y2="22" stroke="#FF9800" stroke-width="2"/>
                        </svg>
                        <h3>Éclairage LED</h3>
                    </div>
                    <div class="control-body">
                        <div class="toggle-switch">
                            <input type="checkbox" id="lighting-toggle" class="toggle-input">
                            <label for="lighting-toggle" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                            <span class="toggle-text">Désactivé</span>
                        </div>
                        <div class="control-settings">
                            <label>Intensité: <span id="lighting-intensity">50</span>%</label>
                            <input type="range" id="lighting-slider" min="0" max="100" value="50" class="slider">
                        </div>
                    </div>
                </div>

                <div class="control-panel">
                    <div class="control-header">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M4 12C4 12 6 8 12 8C18 8 20 12 20 12M4 12C4 12 6 16 12 16C18 16 20 12 20 12" stroke="#2196F3" stroke-width="2"/>
                            <circle cx="12" cy="12" r="2" fill="#2196F3"/>
                        </svg>
                        <h3>Ventilation</h3>
                    </div>
                    <div class="control-body">
                        <div class="toggle-switch">
                            <input type="checkbox" id="ventilation-toggle" class="toggle-input">
                            <label for="ventilation-toggle" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                            <span class="toggle-text">Désactivé</span>
                        </div>
                        <div class="control-settings">
                            <label>Vitesse: <span id="ventilation-speed">3</span></label>
                            <input type="range" id="ventilation-slider" min="1" max="5" value="3" class="slider">
                        </div>
                    </div>
                </div>

                <div class="control-panel">
                    <div class="control-header">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <rect x="4" y="4" width="16" height="16" rx="2" stroke="#9C27B0" stroke-width="2"/>
                            <line x1="4" y1="10" x2="20" y2="10" stroke="#9C27B0" stroke-width="2"/>
                        </svg>
                        <h3>Chauffage</h3>
                    </div>
                    <div class="control-body">
                        <div class="toggle-switch">
                            <input type="checkbox" id="heating-toggle" class="toggle-input">
                            <label for="heating-toggle" class="toggle-label">
                                <span class="toggle-button"></span>
                            </label>
                            <span class="toggle-text">Désactivé</span>
                        </div>
                        <div class="control-settings">
                            <label>Température cible: <span id="heating-target">20</span>°C</label>
                            <input type="range" id="heating-slider" min="10" max="35" value="20" class="slider">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Charts Section -->
        <section class="charts-section">
            <h2 class="section-title">Évolution des Données (24h)</h2>
            <div class="charts-grid">
                <div class="chart-container">
                    <h3 class="chart-title">Température & Humidité</h3>
                    <canvas id="temp-humidity-chart"></canvas>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title">Luminosité & Humidité Sol</h3>
                    <canvas id="light-soil-chart"></canvas>
                </div>
            </div>
        </section>

        <!-- Alerts Section -->
        <section class="alerts-section">
            <h2 class="section-title">Alertes & Notifications</h2>
            <div class="alerts-container" id="alerts-container">
                <div class="alert alert-info">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2"/>
                        <line x1="10" y1="6" x2="10" y2="10" stroke="currentColor" stroke-width="2"/>
                        <circle cx="10" cy="13" r="1" fill="currentColor"/>
                    </svg>
                    <div class="alert-content">
                        <h4>Système initialisé</h4>
                        <p>Connexion établie avec les capteurs de la serre</p>
                        <span class="alert-time">Il y a quelques instants</span>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>GreenHouse Connect</h4>
                <p>Solution intelligente de gestion de serre</p>
            </div>
            <div class="footer-section">
                <h4>Projet BTS</h4>
                <p>Système de surveillance et contrôle automatisé</p>
            </div>
            <div class="footer-section">
                <h4>Statut</h4>
                <p id="footer-status">Tous les systèmes opérationnels</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 GreenHouse Connect - Tous droits réservés à Ryan-Jonas-Raphael-Sacha</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="/front/script.js"></script>
</body>
</html>